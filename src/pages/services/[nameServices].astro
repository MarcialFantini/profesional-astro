---
import BaseLayout from "../../layouts/BaseLayaout.astro";
import { SERVICE_DATA } from "../../consts";
import PrincipalForm from "../../components/PrincipalForm/index.astro";
import Button from "../../components/Button/index.astro";

export function getStaticPaths() {
  return SERVICE_DATA.services.flatMap((service) => ({
    params: { nameServices: service.nameUrl },
  }));
}

const { nameServices } = Astro.params;
const currentService = SERVICE_DATA.services.find(
  (service) => service.nameUrl === nameServices
);

if (!currentService) {
  return Astro.redirect("/404"); // Or handle the case where the service is not found
}

const { sectionTitle, sectionSubtitle, subTitle, subText, items } =
  currentService;
---

<BaseLayout title={sectionTitle} description={sectionSubtitle}>
  <div
    class="relative flex items-center justify-start text-white px-10 min-h-[500px]"
    style={`background-image: url(${currentService.urlImage}) ; background-size: cover; background-position: center;`}
  >
    <div class="max-w-7xl text-left">
      <h1
        class="text-4xl font-extrabold tracking-tight sm:text-5xl lg:text-6xl"
      >
        {sectionTitle}
      </h1>
      <p class="mt-4 max-w-2xl text-xl">
        {sectionSubtitle}
      </p>
      <div class="mt-8">
        <Button text="Ask for a quote" href="#contact-form" />
      </div>
    </div>
  </div>

  <section class="py-16 bg-white px-4 sm:px-6 lg:px-8">
    <div class="max-w-7xl mx-auto">
      <h2 class="text-3xl font-extrabold text-gray-900 text-center">
        {subTitle}
      </h2>
      <p class="mt-4 text-xl text-gray-500 text-center">
        {subText}
      </p>
      <div
        class="mt-12 grid gap-8 sm:grid-cols-2 lg:grid-cols-3 max-w-md mx-auto md:max-w-none"
      >
        {
          items.map((item) => (
            <div class="flex flex-col rounded-lg shadow-lg overflow-hidden border border-gray-200">
              <div class="flex-shrink-0">
                <img
                  class="h-48 w-full object-cover bg-gray-400"
                  src={item.image}
                  alt={item.title}
                />
              </div>
              <div class="flex-1 bg-white p-6 flex flex-col justify-between">
                <div class="flex-1">
                  <h3 class="mt-2 text-2xl leading-7 font-semibold text-gray-900 text-center">
                    {item.title}
                  </h3>
                  <p class="mt-3 text-base text-gray-500 text-center">
                    {item.description}
                  </p>
                </div>
                <div class="mt-6 flex justify-center">
                  <Button text={item.cta} href="#contact-form" />
                </div>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <section id="contact-form" class="py-16 bg-gray-50 px-4 sm:px-6 lg:px-8">
    <div class="max-w-3xl mx-auto">
      <PrincipalForm services={SERVICE_DATA.services} />
    </div>
  </section>
</BaseLayout>
